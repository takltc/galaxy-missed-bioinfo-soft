<tool id="mutserve_annotate" name="Mutserve Annotate" version="2.0.0-rc15+galaxy0" profile="21.05">
    <description>Annotate mtDNA variants with functional information</description>
    <macros>
        <token name="@TOOL_VERSION@">2.0.0-rc15</token>
        <token name="@GALAXY_VERSION@">galaxy0</token>
    </macros>
    <requirements>
        <requirement type="package" version="@TOOL_VERSION@">mutserve</requirement>
        <container type="docker">omniverse/mutserve:2.0.0-rc15</container>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        mutserve annotate
            --input '$input_variants'
            --annotation '$annotation_file'
            --output '$annotated_output'
    ]]></command>
    <inputs>
        <param name="input_variants" type="data" format="tabular" label="Input variant file" help="Tab-delimited variant file generated by Mutserve call (raw output format)."/>
        <param name="annotation_file" type="data" format="tabular" label="Annotation file" help="rCRS annotation file containing gene regions, tRNA, rRNA, and functional annotations."/>
    </inputs>
    <outputs>
        <data name="annotated_output" format="tabular" label="${tool.name} on ${on_string}: Annotated Variants"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="input_variants" value="test_variants.txt"/>
            <param name="annotation_file" value="rCRS_annotation.txt"/>
            <output name="annotated_output" file="expected_annotated.txt" compare="sim_size"/>
        </test>
    </tests>
    <help><![CDATA[
**Mutserve Annotate - Variant Annotation**
==========================================

This tool annotates mtDNA variants with functional information including gene location,
amino acid changes, and known pathogenicity information.

**Overview**
------------

After variant calling with Mutserve, this annotation step adds biological context to
the detected variants, including:

- Gene/region assignment (MT-ND1, MT-CO1, MT-CYTB, etc.)
- Amino acid changes for protein-coding genes
- tRNA and rRNA annotations
- D-loop and control region identification
- Conservation and population frequency information

**Inputs**
----------

1. **Variant file**: Tab-delimited file from Mutserve call (raw format)
2. **Annotation file**: rCRS annotation file (available from Mutserve GitHub)

**Outputs**
-----------

Annotated variant file with additional columns:

- Gene/Region
- Amino acid change (if applicable)
- Variant type (synonymous, missense, tRNA, etc.)
- Functional impact predictions

**Annotation File**
-------------------

The default rCRS annotation file can be downloaded from:
https://raw.githubusercontent.com/seppinho/mutserve/master/files/rCRS_annotation_2020-08-20.txt

**Citation**
------------

Weissensteiner H, et al. Contamination detection in sequencing studies using 
the mitochondrial phylogeny. Genome Res. 2021;31:309-316.
    ]]></help>
    <citations>
        <citation type="doi">10.1101/gr.256545.119</citation>
    </citations>
</tool>
